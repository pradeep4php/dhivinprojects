org: kmpradeep
app: apiproj
service: aws-webscrapper-api-project
frameworkVersion: '3'

provider:
  name: aws
  runtime: nodejs14.x

	
layers:
  webdriver:
    name: ${sls:stage}-layerName # optional, Deployed Lambda layer name
    description: Description of what the lambda layer does # optional, Description to publish to AWS
    compatibleRuntimes: # optional, a list of runtimes this layer is compatible with
      - nodejs14.x
    compatibleArchitectures: # optional, a list of architectures this layer is compatible with
      - x86_64
      - arm64
    package:
      artifact: layerSource.zip

functions:
  
  email:
    handler: handler.scrapper
    events:
      - httpApi:
          path: /
          method: post
  status:
    handler: handler.status
    events:
      - httpApi:
          path: /status/{id}
          method: get
  emailaddress:
    handler: handler.draftemail
    events:
      - httpApi:
          path: /draftemail/{id}
          method: get
  webcrawlerjob:
    handler: worker.consumer
    

    events:
      - sqs: arn:aws:sqs:us-east-2:862836902890:scrapperjobqueue

custom:
  serverless-offline-sqs-external:
    apiVersion: '2012-11-05'
    endpoint: https://sqs.us-east-2.amazonaws.com/862836902890/scrapperjobqueue
    region: us-east-2

package:
  patterns:
    - '!layerSource.zip'
    - '!.vscode/**'
    - '!.serverless/**'
    - '!.vs/**'
    - '!migrations/**'

plugins:
  - serverless-offline
  - serverless-offline-sqs-external
